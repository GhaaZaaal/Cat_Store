<!-- confirm_reservation.html -->
{% extends 'base.html' %} {% block content %}
<h1 class="text-center mb-4">Confirm Reservation</h1>

<div class="container">
	<div class="row">
		<div class="col-md-5 text-center">
			<div class="card cat-card">
				<img
					class="img-fluid cat-image"
					src="{{ url_for('static', filename='cat-images/' + cat.image) }}"
					alt="Cat Image {{ cat.name }}"
					loading="lazy"
				/>
			</div>
		</div>
		<div class="col-md-5">
			<div class="cat-details">
				<h3 class="cat-name">{{ cat.name }}</h3>
				<p><strong>Color:</strong> {{ cat.color }}</p>
				<p><strong>Eye Color:</strong> {{ cat.eye_color }}</p>
				<p><strong>Age:</strong> {{ cat.age }}</p>
				<p><strong>Gender:</strong> {{ cat.gender }}</p>
				<p>
					<strong>Price:</strong>
					<span class="price">${{ cat.price }}</span>
				</p>
				<p>
					<strong>Status:</strong> {% if cat.reserved_by %} Reserved
					{% else %} Available {% endif %}
				</p>
			</div>
			<br />
			<form
				class="confirm-details"
				action="{{ url_for('auth.confirm_Reservation', cat_id=cat.id) }}"
				method="POST"
			>
				{% if remaining_time %}
				<div class="timer">
					<p>
						<strong>Reservation Time Remaining:</strong>
						<span id="timeLeft"></span>
					</p>
				</div>
				<script>
					// JavaScript to calculate the countdown from remaining time
					const totalSeconds = {{ remaining_time.total_seconds() | int }};
					let countdown = totalSeconds;

					const timerElement = document.getElementById('timeLeft');
					function updateTimer() {
					    const days = Math.floor(countdown / (24 * 3600));
					    const hours = Math.floor((countdown % (24 * 3600)) / 3600);
					    const minutes = Math.floor((countdown % 3600) / 60);
					    const seconds = countdown % 60;

					    timerElement.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;

					    if (countdown > 0) {
					        countdown -= 1;
					        setTimeout(updateTimer, 1000);
					    } else {
					        // If time runs out, refresh the page
					        setTimeout(function() {
					            location.reload();
					        }, 1000);  // Refresh after 1 second
					    }
					}

					updateTimer();
				</script>
				{% endif %}
				<input
					type="hidden"
					name="csrf_token"
					value="{{ csrf_token() }}"
				/>

				{% if confirmed and not gallery %}
				<button
					type="button"
					class="btn btn-success"
					id="confirmButton"
					disabled
				>
					Confirmed
				</button>
				<button type="submit" class="btn btn-danger" id="cancelButton">
					Cancel
				</button>
				{% elif reserve_again %}
				<button
					type="submit"
					class="btn btn-success"
					id="reserveAgainButton"
				>
					Reserve Again
				</button>
				<a
					href="{{ url_for('auth.gallery') }}"
					class="btn btn-outline-secondary"
					>Gallery</a
				>
				{% elif gallery %}
				<button
					type="submit"
					class="btn btn-primary"
					id="confirmButton"
				>
					Confirm Reservation
				</button>
				<a
					href="{{ url_for('auth.gallery') }}"
					class="btn btn-outline-secondary"
					>Gallery</a
				>
				{% else %}
				<button
					type="submit"
					class="btn btn-success"
					id="confirmButton"
				>
					Confirm Reservation
				</button>
				{% endif %}
			</form>
		</div>
	</div>
</div>

<style>
	body {
		background: #f8f9fa;
		font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
	}

	.container {
		margin-top: 20px;
	}

	.cat-card {
		box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
		border-radius: 15px;
		overflow: hidden;
		margin-bottom: 20px;
		background: #ffffff;
		transition: box-shadow 0.3s ease;
	}

	.cat-card:hover {
		box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
	}

	.cat-image {
		width: 100%;
		height: auto;
		max-height: 300px; /* Adjust this value as needed */
		object-fit: cover;
		transition: transform 0.3s ease;
		border-radius: 15px;
	}

	.cat-image:hover {
		transform: scale(1.05);
	}

	.cat-details {
		font-size: 1rem;
		padding: 20px;
		background: #ffffff;
		border-radius: 15px;
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	}
	.confirm-details {
		font-size: 1rem;
		padding: 20px;
		background: #ffffff;
		border-radius: 15px;
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	}

	.cat-name {
		font-size: 1.8rem;
		margin-bottom: 10px;
		color: #333;
	}

	.price {
		font-size: 1.4rem;
		color: #28a745;
		font-weight: bold;
	}

	.btn {
		border-radius: 25px;
		padding: 10px 20px;
		font-size: 1rem;
		text-transform: uppercase;
	}

	.btn-primary {
		background-color: #007bff;
		border: none;
		color: #ffffff;
	}

	.btn-primary:hover {
		background-color: #0056b3;
	}

	.btn-success {
		background-color: #28a745;
		border: none;
		color: #ffffff;
	}

	.btn-success:hover {
		background-color: #1e7e34;
	}

	.btn-danger {
		background-color: #dc3545;
		border: none;
		color: #ffffff;
	}

	.btn-danger:hover {
		background-color: #c82333;
	}

	.btn-outline-secondary {
		border-color: #6c757d;
		color: #6c757d;
	}

	.btn-outline-secondary:hover {
		background-color: #6c757d;
		color: #ffffff;
	}

	.timer p {
		font-size: 1.2rem;
		color: #333;
	}
</style>

{% endblock %}
